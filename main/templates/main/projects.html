{% extends "main/base.html" %} {% block content %}
<div class="max-w-7xl mx-auto px-2 sm:px-4">
  <div
    class="rounded-xl overflow-hidden p-4 sm:p-6 md:p-8 mb-6 md:mb-8 neu-surface"
  >
    <h1
      class="text-2xl sm:text-3xl md:text-3xl font-bold text-gray-800 dark:text-white mb-4 sm:mb-6 animate-fade-in-up"
      style="animation-delay: 0.1s"
    >
      My Projects
    </h1>

    <!-- Project description text -->
    <div class="mb-6 sm:mb-8 animate-fade-in-up" style="animation-delay: 0.3s">
      <p
        class="text-base sm:text-lg text-gray-700 dark:text-gray-300 leading-relaxed"
      >
        Discover my collection of creative and functional projectsâ€”each built
        with precision, passion, and purpose. Click any card to explore the
        details.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
      {% for project in projects %}
      <div
        class="relative rounded-lg overflow-hidden transition-all duration-300 ease-in-out h-full cursor-pointer hover:-translate-y-1 animate-fade-in-up neu-surface flex flex-col"
        style="animation-delay: 0.5s"
        onclick="openModal('modal-{{ project.id }}')"
      >
        <div
          class="h-40 sm:h-48 md:h-48 flex items-center justify-center overflow-hidden"
        >
          {% if project.video %}
          <!-- Display video thumbnail/play icon for videos -->
          <div class="relative w-full h-full flex items-center justify-center">
            <i
              data-lucide="play-circle"
              class="w-12 h-12 sm:w-16 sm:h-16 text-blue-500"
            ></i>
            <span
              class="absolute bottom-2 right-2 bg-blue-500 text-white text-xs px-2 py-1 rounded"
              >Video</span
            >
          </div>
          {% elif project.image %}
          <img
            src="{{ project.image.url }}"
            alt="{{ project.title }}"
            class="h-full w-full p-2 sm:p-4 object-cover transition-transform duration-500 ease-in-out hover:scale-110"
            loading="lazy"
          />
          {% else %}
          <i
            data-lucide="image"
            class="w-12 h-12 sm:w-16 sm:h-16 text-gray-400 animate-pulse"
          ></i>
          {% endif %}
        </div>
        <div class="p-3 sm:p-4 flex-grow">
          <h3
            class="font-semibold text-base sm:text-lg text-gray-800 dark:text-white mb-2 line-clamp-2"
          >
            {{ project.title }}
          </h3>
          <p
            class="text-xs sm:text-sm text-gray-600 dark:text-gray-300 mb-3 line-clamp-3"
            title="{{ project.description }}"
            style="
              overflow: hidden;
              text-overflow: ellipsis;
              display: -webkit-box;
            "
          >
            {{ project.description|truncatewords:20 }}
          </p>
          <div class="mt-2">
            <span class="text-xs sm:text-sm text-gray-500 dark:text-gray-400">
              {{ project.created_at|date:"M Y" }}
            </span>
          </div>
        </div>
        <div
          class="px-3 py-2 bg-gray-100 dark:bg-transparent border-t border-gray-200 dark:border-gray-600"
        >
          <div class="flex justify-end bg-transparent">
            {% if project.url %}
            <a
              href="{{ project.url }}"
              class="inline-flex items-center px-4 py-2 rounded-md text-sm font-medium transition-all duration-300 min-h-[36px] neu-button"
              target="_blank"
              onclick="event.stopPropagation()"
            >
              View Project
              <i data-lucide="arrow-up-right" class="w-4 h-4 ml-2"></i>
            </a>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Modal for project {{ project.id }} -->
      <div
        id="modal-{{ project.id }}"
        class="fixed inset-0 z-50 hidden overflow-y-auto"
      >
        <div
          id="modal-backdrop-{{ project.id }}"
          class="fixed inset-0 bg-black transition-all duration-300 ease-in-out"
          onclick="closeModal('modal-{{ project.id }}')"
        ></div>
        <div class="min-h-screen flex items-center justify-center p-4">
          <div
            id="modal-content-{{ project.id }}"
            class="relative bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-xl transform transition-all duration-300 ease-in-out w-full max-w-3xl my-8 max-h-[90vh] flex flex-col"
          >
            <div class="overflow-y-auto flex-grow">
              <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                  <h2 class="text-2xl font-bold text-gray-800 dark:text-white">
                    {{ project.title }}
                  </h2>
                  <button
                    onclick="closeModal('modal-{{ project.id }}')"
                    class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
                  >
                    <i data-lucide="x" class="w-6 h-6"></i>
                  </button>
                </div>

                <div class="mb-6">
                  {% if project.image %}
                  <img
                    src="{{ project.image.url }}"
                    alt="{{ project.title }}"
                    class="w-full h-64 object-cover rounded-lg"
                  />
                  {% endif %}
                </div>

                <div class="prose dark:prose-invert max-w-none mb-6">
                  <p
                    class="text-gray-700 dark:text-gray-300 whitespace-pre-line"
                  >
                    {{ project.description }}
                  </p>
                </div>

                <div class="flex flex-wrap gap-2 mb-6">
                  <span class="text-sm text-gray-500 dark:text-gray-400">
                    {{ project.created_at|date:"F d, Y" }}
                  </span>
                </div>
              </div>
            </div>

            {% if project.url %}
            <div
              class="px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600"
            >
              <div class="flex justify-end">
                <a
                  href="{{ project.url }}"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-300"
                  target="_blank"
                >
                  View Project
                  <i data-lucide="external-link" class="w-4 h-4 ml-2"></i>
                </a>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>

      {% empty %}
      <div
        class="col-span-full text-center py-8 sm:py-12 animate-fade-in-up"
        style="animation-delay: 0.2s"
      >
        <i
          data-lucide="folder-x"
          class="w-12 h-12 sm:w-16 sm:h-16 mx-auto text-gray-400 mb-3 sm:mb-4 animate-bounce"
        ></i>
        <p class="text-sm sm:text-base text-gray-600 dark:text-gray-300">
          No projects to display yet. Check back soon!
        </p>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes bounce {
    0%,
    20%,
    50%,
    80%,
    100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-20px);
    }
    60% {
      transform: translateY(-10px);
    }
  }

  .animate-fade-in-up {
    animation: fadeInUp 0.6s ease-out forwards;
    opacity: 0;
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .animate-bounce {
    animation: bounce 2s infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
</style>

<script>
  function openModal(modalId) {
    const modal = document.getElementById(modalId);
    const backdrop = document.getElementById(
      `modal-backdrop-${modalId.split("-")[1]}`
    );
    const content = document.getElementById(
      `modal-content-${modalId.split("-")[1]}`
    );

    // Show modal
    modal.classList.remove("hidden");
    document.body.classList.add("overflow-hidden");

    // Trigger animations
    setTimeout(() => {
      backdrop.classList.add("bg-opacity-75");
      content.classList.remove("translate-y-4", "opacity-0");
      content.classList.add("translate-y-0", "opacity-100");
    }, 10);
  }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    const backdrop = document.getElementById(
      `modal-backdrop-${modalId.split("-")[1]}`
    );
    const content = document.getElementById(
      `modal-content-${modalId.split("-")[1]}`
    );

    // Trigger animations
    backdrop.classList.remove("bg-opacity-75");
    content.classList.remove("translate-y-0", "opacity-100");
    content.classList.add("translate-y-4", "opacity-0");

    // Hide modal after animation completes
    setTimeout(() => {
      modal.classList.add("hidden");
      document.body.classList.remove("overflow-hidden");
    }, 300);
  }

  // Close modal when pressing Escape key
  document.addEventListener("keydown", function (event) {
    if (event.key === "Escape") {
      document.querySelectorAll('[id^="modal-"]').forEach((modal) => {
        if (!modal.classList.contains("hidden")) {
          closeModal(modal.id);
        }
      });
    }
  });

  // Initialize lucide icons
  document.addEventListener("DOMContentLoaded", function () {
    lucide.createIcons();
  });
</script>
{% endblock %}
